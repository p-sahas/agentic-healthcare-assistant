-- mem_procedures: 6 rows
-- Exported from Supabase for deterministic seeding

-- Clear existing data
TRUNCATE TABLE mem_procedures CASCADE;

INSERT INTO mem_procedures (id, name, description, context_when, steps, conditions, examples, category, active, version, created_at, updated_at) VALUES ('256fdd3f-5bc1-4fce-aaa6-30d3062ab94a', 'book_new_appointment', 'Book a new appointment for a patient with a doctor at a location', 'When a patient requests to schedule a new appointment', '[{"order": 1, "action": "identify_patient", "description": "Verify patient identity using phone number or patient ID. If not found, suggest registration."}, {"order": 2, "action": "identify_requirements", "description": "Ask for: specialty needed, preferred doctor (if any), preferred location, date/time preferences, reason for visit."}, {"order": 3, "action": "check_availability", "description": "Query CRM database for available doctors matching specialty and location within requested timeframe."}, {"order": 4, "action": "present_options", "description": "Present 2-3 available time slots to the patient. Include doctor name, specialty, location, and timing."}, {"order": 5, "action": "confirm_selection", "description": "Ask patient to confirm their choice. Verify all details are correct."}, {"order": 6, "action": "create_booking", "description": "Create booking record in CRM with status=''CONFIRMED'' and source=''MEMORY''."}, {"order": 7, "action": "send_confirmation", "description": "Confirm booking details to patient: appointment ID, date, time, doctor, location, instructions."}, {"order": 8, "action": "store_in_memory", "description": "Store appointment details in long-term memory for future reference."}]', '{"constraints": ["Appointments must be at least 1 hour in the future", "No double-booking for same doctor/time slot"], "preconditions": ["Patient must be registered in CRM", "Doctor must be active and available", "Location must be operational"]}', '["Patient: I need to see a cardiologist next week", "Patient: Can I book an appointment with Dr. Silva?", "Patient: I want to schedule a checkup at the main hospital"]', 'booking', True, 1, '2026-02-20 22:07:33.119714+00:00', '2026-02-20 22:07:33.119714+00:00');
INSERT INTO mem_procedures (id, name, description, context_when, steps, conditions, examples, category, active, version, created_at, updated_at) VALUES ('a114d54e-6b6e-4065-8da6-3e8b27bc60e8', 'cancel_appointment', 'Cancel an existing appointment', 'When a patient wants to cancel a scheduled appointment', '[{"order": 1, "action": "identify_appointment", "description": "Ask for booking ID or appointment details. Query CRM to find the booking."}, {"order": 2, "action": "verify_ownership", "description": "Confirm the appointment belongs to the current patient."}, {"order": 3, "action": "check_status", "description": "Verify appointment is not already cancelled or completed."}, {"order": 4, "action": "ask_reason", "description": "Optionally ask for cancellation reason (for record-keeping)."}, {"order": 5, "action": "confirm_cancellation", "description": "Ask patient to confirm they want to cancel the appointment. Mention cancellation policy if applicable."}, {"order": 6, "action": "update_booking", "description": "Update CRM booking record with status=''CANCELLED'' and add cancellation reason to notes."}, {"order": 7, "action": "send_confirmation", "description": "Confirm cancellation to patient. Mention rescheduling options if relevant."}, {"order": 8, "action": "update_memory", "description": "Update long-term memory to reflect cancelled status."}]', '{"constraints": ["Last-minute cancellations may incur fees (policy-dependent)"], "preconditions": ["Appointment must exist", "Appointment must not be completed"]}', '["Patient: I need to cancel my appointment tomorrow", "Patient: Cancel my booking with Dr. Silva please", "Patient: I can''t make it to my appointment"]', 'booking', True, 1, '2026-02-20 22:07:37.571774+00:00', '2026-02-20 22:07:37.571774+00:00');
INSERT INTO mem_procedures (id, name, description, context_when, steps, conditions, examples, category, active, version, created_at, updated_at) VALUES ('cd7229cf-537f-4b66-9fed-7cf169e078bd', 'check_appointment_status', 'Look up and provide status of patient''s appointments', 'When a patient asks about their upcoming or past appointments', '[{"order": 1, "action": "identify_patient", "description": "Verify patient identity using phone number or patient ID."}, {"order": 2, "action": "query_appointments", "description": "Query CRM for patient''s appointments. Filter by timeframe (upcoming, past, all) based on query."}, {"order": 3, "action": "format_results", "description": "Format appointments in readable format: date, time, doctor, location, status, reason."}, {"order": 4, "action": "present_to_patient", "description": "Present appointment list to patient. Highlight upcoming appointments."}, {"order": 5, "action": "offer_actions", "description": "Ask if patient wants to reschedule, cancel, or get more details about any appointment."}]', '{"preconditions": ["Patient must be registered"]}', '["Patient: What appointments do I have coming up?", "Patient: When is my next doctor visit?", "Patient: Show me my appointment history"]', 'inquiry', True, 1, '2026-02-20 22:07:39.636600+00:00', '2026-02-20 22:07:39.636600+00:00');
INSERT INTO mem_procedures (id, name, description, context_when, steps, conditions, examples, category, active, version, created_at, updated_at) VALUES ('2037942b-a004-4559-9f4b-f05c9dd1e72e', 'find_doctor', 'Help patient find a suitable doctor by specialty or name', 'When a patient needs to find a doctor but hasn''t decided on booking yet', '[{"order": 1, "action": "understand_needs", "description": "Ask patient what they''re looking for: specialty, doctor name, location preferences, any specific requirements."}, {"order": 2, "action": "query_doctors", "description": "Query CRM database for matching doctors. Filter by specialty, location, active status."}, {"order": 3, "action": "present_options", "description": "Present 3-5 matching doctors with: name, specialty, locations, general availability."}, {"order": 4, "action": "offer_booking", "description": "Ask if patient wants to book an appointment with any of the listed doctors."}, {"order": 5, "action": "follow_up", "description": "If yes, transition to ''book_new_appointment'' procedure. If no, ask if they need more information."}]', '{"preconditions": []}', '["Patient: I need a cardiologist", "Patient: Do you have Dr. Fernando?", "Patient: Who are your pediatricians in Colombo?"]', 'inquiry', True, 1, '2026-02-20 22:07:41.631618+00:00', '2026-02-20 22:07:41.631618+00:00');
INSERT INTO mem_procedures (id, name, description, context_when, steps, conditions, examples, category, active, version, created_at, updated_at) VALUES ('e16a9b4d-33de-4a7e-afaa-8011f4261c03', 'reschedule_appointment', 'Reschedule an existing appointment to a new date/time', 'When a patient requests to change an existing appointment time', '[{"order": 1, "action": "identify_appointment", "description": "Ask for booking ID or appointment details (doctor, date). Query CRM to find the booking."}, {"order": 2, "action": "verify_ownership", "description": "Confirm the appointment belongs to the current patient."}, {"order": 3, "action": "check_status", "description": "Verify appointment status is ''CONFIRMED'' or ''PENDING'' (not ''CANCELLED'' or ''COMPLETED'')."}, {"order": 4, "action": "ask_new_preferences", "description": "Ask patient for new preferred date/time. Check if they want same doctor/location."}, {"order": 5, "action": "check_new_availability", "description": "Query CRM for available slots matching new preferences."}, {"order": 6, "action": "present_options", "description": "Present available alternatives to patient."}, {"order": 7, "action": "confirm_new_time", "description": "Ask patient to confirm new appointment time."}, {"order": 8, "action": "update_booking", "description": "Update CRM booking record with new date/time. Set status=''RESCHEDULED''."}, {"order": 9, "action": "send_confirmation", "description": "Send updated appointment details to patient."}, {"order": 10, "action": "update_memory", "description": "Update long-term memory with new appointment details."}]', '{"constraints": ["New time must be at least 2 hours in the future", "Must maintain minimum 24h notice (configurable)"], "preconditions": ["Appointment must exist in CRM", "Appointment must not be in the past", "Appointment status must be active"]}', '["Patient: I need to reschedule my appointment with Dr. Perera", "Patient: Can I move my appointment to next Monday?", "Patient: Something came up, I can''t make it tomorrow"]', 'booking', True, 1, '2026-02-20 22:07:35.437795+00:00', '2026-02-20 22:07:35.437795+00:00');
INSERT INTO mem_procedures (id, name, description, context_when, steps, conditions, examples, category, active, version, created_at, updated_at) VALUES ('cbee77a9-231b-4b42-bebc-6dff9c581fb6', 'update_patient_info', 'Update patient''s personal information in CRM', 'When a patient wants to change their contact details, address, or medical info', '[{"order": 1, "action": "identify_patient", "description": "Verify patient identity."}, {"order": 2, "action": "ask_what_to_update", "description": "Ask which information needs updating: phone, email, address, emergency contact, etc."}, {"order": 3, "action": "collect_new_info", "description": "Collect the new information from patient. Validate format (e.g., phone number, email)."}, {"order": 4, "action": "confirm_changes", "description": "Repeat back the changes to patient for confirmation."}, {"order": 5, "action": "update_crm", "description": "Update patient record in CRM database."}, {"order": 6, "action": "confirm_success", "description": "Confirm to patient that information has been updated."}, {"order": 7, "action": "update_memory", "description": "Store the update in long-term memory as a fact."}]', '{"constraints": ["Some fields may require verification (e.g., changing registered phone number)"], "preconditions": ["Patient must be registered"]}', '["Patient: I changed my phone number", "Patient: Can you update my email address?", "Patient: I moved to a new address"]', 'administrative', True, 1, '2026-02-20 22:07:43.543537+00:00', '2026-02-20 22:07:43.543537+00:00');

-- End of mem_procedures
